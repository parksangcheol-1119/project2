<?xml version="1.0" encoding="UTF-8"?>

<!-- xml 파일이 mapper 역할을 하기 위해서 해당 DOCTYPE이 반드시 필요하다.  -->
<!DOCTYPE mapper 
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

 <!-- 
 	매퍼의 namespace 속성
 		해당 매퍼 파일을 호출하기 위해 우선 인터페이스를 정의한다.
 		namespace 속성에 인터페이스의 풀 경로를 기술한다. ( 패키지 포함 )
 		해당 인터페이스는 컨트롤러와 Mapper( DAO ) 사이에서 중재 역할을 하는
 		서비스 객체로 사용된다.
 		
 	id 속성
 		실제 호출되는 함수명과 동일한 이름으로 기술한다.
 	
 	resultType
 		쿼리 실행 후 반환되는 값의 타입을 명시한다.
 		이때는 패키지명을 포함한 풀 경로를 기술해야 한다.
  -->
  
  <!-- 
  	Mapper에서의 파라미터 사용법
  		형식1]
  			listPage(int s, int e)와 같이 추상메소드를 통해 파라미터가 전달되면
  			순서대로 param1, param2로 사용할 수 있다.
   -->
<mapper namespace="mybatis.MybatisDAOImpl">

	<select id="getTotalCount" resultType="int">
		SELECT COUNT(*) FROM myboard	
	</select>
	
	<select id="listPage" resultType="mybatis.MyBoardDTO">
		SELECT * FROM (
			SELECT Tb.*, rownum rNum FROM (
				SELECT * FROM myboard ORDER BY idx DESC
			) Tb
		)
		WHERE rNum BETWEEN #{param1} AND #{param2}
	</select>
	
	<insert id="write">
		INSERT INTO myboard(idx, id, name, contents)
		VALUES
		(myboard_seq.nextval, #{_id}, #{_name}, #{_contents})
	</insert>

</mapper>